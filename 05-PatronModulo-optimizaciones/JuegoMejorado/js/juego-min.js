(()=>{"use strict";let t=(()=>{let t=["C","D","H","S"],a=["J","Q","K","A"],e=[],r=[];class n{constructor(t,a,e){this.nombre=t,this.puntos=0,this.elementoPuntos=a,this.elementoCartas=e}agregarCarta(t){this.puntos+=i(t),this.actualizarPuntos(),this.mostrarCarta(t)}actualizarPuntos(){this.elementoPuntos.innerText=this.puntos}mostrarCarta(t){let a=document.createElement("img");a.classList.add("carta"),a.src=`/05-PatronModulo-optimizaciones/JuegoMejorado/assets/cartas/${t}.png`,this.elementoCartas.append(a)}reiniciar(){this.puntos=0,this.actualizarPuntos(),this.elementoCartas.innerHTML=""}}let s=()=>{e=[];for(let r=2;r<=10;r++)for(let n of t)e.push(r+n);for(let s of a)for(let o of t)e.push(s+o);return _.shuffle(e)},o=()=>{if(0===e.length)throw"No hay cartas en el mazo";return e.pop()},i=t=>{let a=t.substring(0,t.length-1);return isNaN(a)?"A"===a?11:10:parseInt(a)},l=()=>{let[t,a]=r,e;u(e=t.puntos>21?"\xa1Te has pasado! Crupier gana.":a.puntos>21?"\xa1Crupier se ha pasado! \xa1Ganaste!":t.puntos>a.puntos?"\xa1Felicidades! Has ganado.":t.puntos<a.puntos?"Crupier gana. \xa1Mejor suerte la pr\xf3xima!":"\xa1Empate!")},u=t=>{let a=document.getElementById("resultado");a?(a.textContent=t,a.style.display="block"):console.error("Elemento de resultado no encontrado")},p=()=>{let[t,a]=r;for(;a.puntos<17&&a.puntos<t.puntos;)a.agregarCarta(o());l()},d=()=>{r.forEach(t=>t.agregarCarta(o()))};return{iniciarJuego(t,a){e=s(),(r=[new n("Jugador",t.puntos,t.cartas),new n("Crupier",a.puntos,a.cartas)]).forEach(t=>t.reiniciar()),document.getElementById("resultado").style.display="none",setTimeout(d,500)},pedirCarta(){let[t]=r;return t.agregarCarta(o()),!(t.puntos>=21)},plantarse:p}})(),a=(()=>{let t={btnPedir:"#pedir-carta",btnPlantarse:"#plantarse",btnNuevaPartida:"#nueva-partida",totalJugador:"#total-jugador",totalCrupier:"#total-crupier",cartasJugador:"#cartas-jugador",cartasCrupier:"#cartas-crupier"},a=t=>document.querySelector(t);return{getDOMStrings:()=>t,getElements:()=>({btnPedir:a(t.btnPedir),btnPlantarse:a(t.btnPlantarse),btnNuevaPartida:a(t.btnNuevaPartida)}),getJugadorElements:()=>({puntos:a(t.totalJugador),cartas:a(t.cartasJugador)}),getCrupierElements:()=>({puntos:a(t.totalCrupier),cartas:a(t.cartasCrupier)}),toggleButtons(e,r){a(t.btnPedir).disabled=!e,a(t.btnPlantarse).disabled=!r}}})(),e=((t,a)=>{let e=()=>{let e=a.getElements();e.btnPedir.addEventListener("click",()=>{t.pedirCarta()||(a.toggleButtons(!1,!1),t.plantarse())}),e.btnPlantarse.addEventListener("click",()=>{a.toggleButtons(!1,!1),t.plantarse()}),e.btnNuevaPartida.addEventListener("click",r)},r=()=>{t.iniciarJuego(a.getJugadorElements(),a.getCrupierElements()),a.toggleButtons(!0,!0)};return{init(){console.log("Aplicaci\xf3n iniciada"),e(),r()}}})(t,a);e.init()})();